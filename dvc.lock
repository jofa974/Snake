schema: '2.0'
stages:
  make_apple:
    cmd: python gen_xy.py
    deps:
    - path: gen_xy.py
      md5: cfe9ae254005c2fe3fea36841676cb55
      size: 357
    - path: ui/__init__.py
      md5: 77207fd95a3f7bd6e709fe4e197787aa
      size: 263
    outs:
    - path: apple_position.in
      md5: eacbac307d435663957ba61e531ea071
      size: 61352
  train:
    cmd: mkdir -p metrics/train && python train.py
    deps:
    - path: apple_position.in
      md5: 5cbfd66e993b8ed0c50a8cb4c6ccfbab
      size: 61282
    - path: brains/dqn.py
      md5: c37185be05cb20815d4bb606e582d098
      size: 7694
    - path: brains/dqn_cnn.py
      md5: 74599dd2e269e6596ed082c6ec8ba4ac
      size: 1450
    - path: neural_net/pytorch_cnn.py
      md5: a75da9f53fb53cd0380ea714ca20a6d6
      size: 2261
    - path: train.py
      md5: f3534d33c9aabe4dda0db05080af2e28
      size: 1412
    params:
      params.yaml:
        train:
          nb_episodes: 100
          nb_epochs: 50
          batch_sample_size: 128
          moves_per_epoch: 200
    outs:
    - path: last_brain.pth
      md5: 9bc53df2ee8166f8a4919265ce9313d5
      size: 1352651
    - path: metrics/train/loss.csv
      md5: 0dee5b29ef7353e5adb29d19a41ea722
      size: 2374
    - path: metrics/train/rewards.csv
      md5: 3fa51af73f6e300ac0e00dd2f038a354
      size: 1508
  train@0:
    cmd: mkdir -p metrics/train/dqn_ann && python train.py -a dqn -n ann
    deps:
    - path: brains/dqn.py
      md5: 03844e6e152a579cc1c57a108be4a362
      size: 7746
    - path: brains/dqn_ann.py
      md5: 12099e5b5e20e8969f6b53c5b330cd41
      size: 2688
    - path: neural_net/pytorch_ann.py
      md5: 4f9b87d98ddcdb8f8f0b2924e9df0f85
      size: 1277
    - path: train.py
      md5: b2628eafe9d70234a5b55043f04a0c6c
      size: 2665
    params:
      params.yaml:
        dqn_ann.train:
          max_moves: 500
          nb_episodes: 100
          nb_epochs: 50
          batch_size: 128
    outs:
    - path: metrics/train/dqn_ann/cum_rewards.csv
      md5: e6a63710c24fbe692a0a31abc9a6356a
      size: 641
    - path: metrics/train/dqn_ann/loss.csv
      md5: a0a1c39fe3cd4d5c4dca5fbfbed7de31
      size: 2384
    - path: metrics/train/dqn_ann/rewards.csv
      md5: 649be075e54046c04552dc8c60888a94
      size: 988
    - path: output/dqn_ann/last_brain.pth
      md5: 3d428ae0f38e7167ef0ec9438b25a0ae
      size: 1352651
  train@1:
    cmd: mkdir -p metrics/train/dqn_cnn && python train.py -a dqn -n cnn
    deps:
    - path: brains/dqn.py
      md5: 03844e6e152a579cc1c57a108be4a362
      size: 7746
    - path: brains/dqn_cnn.py
      md5: c59463e691b9ca1fa36fcd24ef81aab1
      size: 1731
    - path: neural_net/pytorch_cnn.py
      md5: 7590ceeeddde2b91696474fdd9c94b61
      size: 2867
    - path: train.py
      md5: b2628eafe9d70234a5b55043f04a0c6c
      size: 2665
    params:
      params.yaml:
        dqn_cnn.train:
          max_moves: 500
          nb_episodes: 100000
          nb_epochs: 50
          batch_size: 128
    outs:
    - path: metrics/train/dqn_cnn/cum_rewards.csv
      md5: 76b96e3fde5df44fc7330fb3cd230e2f
      size: 866105
    - path: metrics/train/dqn_cnn/loss.csv
      md5: 11d62e062545511327f9e1c950cd0ee2
      size: 2660097
    - path: metrics/train/dqn_cnn/rewards.csv
      md5: 338836702e1a9b4c380ff54796007d6f
      size: 1193149
    - path: output/dqn_cnn/last_brain.pth
      md5: 1782d99271b8131fb1ae6a921798d566
      size: 7602379
  test@0:
    cmd: mkdir -p metrics/test/dqn_ann && python test.py -a dqn -n ann
    deps:
    - path: output/dqn_ann/last_brain.pth
      md5: 3d428ae0f38e7167ef0ec9438b25a0ae
      size: 1352651
    - path: test.py
      md5: 10acbd5d0b22c31dea2ea08afbd71fd0
      size: 1845
    params:
      params.yaml:
        dqn_ann.test:
          nb_episodes: 100
    outs:
    - path: metrics/test/dqn_ann/scores.csv
      md5: a97794fa841db586ab5295d310a3b9db
      size: 707
  test@1:
    cmd: mkdir -p metrics/test/dqn_cnn && python test.py -a dqn -n cnn
    deps:
    - path: output/dqn_cnn/last_brain.pth
      md5: 1782d99271b8131fb1ae6a921798d566
      size: 7602379
    - path: test.py
      md5: 10acbd5d0b22c31dea2ea08afbd71fd0
      size: 1845
    params:
      params.yaml:
        dqn_cnn.test:
          nb_episodes: 100
    outs:
    - path: metrics/test/dqn_cnn/scores.csv
      md5: 3dad98421ccf4f1695108f0b252e4276
      size: 707
